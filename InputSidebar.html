<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <h3>섭외 메일 입력</h3>
    <textarea id="emailList" style="width: 100%; height: 200px;" placeholder="줄바꿈 된 이메일 리스트를 붙여넣으세요"></textarea>
    <br><br>
    <button onclick="submitEmails()">적용</button>

    <script>
      function submitEmails() {
        const rawText = document.getElementById("emailList").value;
        google.script.run
          .withSuccessHandler(() => {
            alert("섭외 메일 입력이 완료되었습니다!");
            google.script.host.close();
          })
          .withFailureHandler(error => {
            alert("오류 발생: " + error.message);
          })
          .appendEmailsToSheet(rawText);
      }
    </script>
  </body>
</html>
